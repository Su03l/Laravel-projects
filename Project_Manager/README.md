# نظام إدارة المشاريع (Project Manager API)

نظام مرن لإدارة المشاريع مبني باستخدام Laravel. يستعرض هذا المشروع مفاهيم متقدمة مثل **العلاقات متعددة الأشكال (Polymorphic Relationships)** لربط الملاحظات والملفات بأكثر من مودل (مشاريع ومهام) ديناميكياً، بالإضافة إلى إدارة احترافية لرفع وتخزين الملفات.

## المميزات الرئيسية

-   **إدارة المشاريع والمهام:** إنشاء مشاريع وإسناد مهام متعددة لها مع تتبع حالة الإنجاز.
-   **ملاحظات ذكية (Polymorphic):** إمكانية إضافة ملاحظات سواء للمشروع أو للمهمة باستخدام جدول واحد فقط في قاعدة البيانات.
-   **المرفقات (رفع الملفات):**
    -   رفع صور أو ملفات PDF للمشاريع أو المهام.
    -   إرجاع رابط كامل (Full URL) للصورة جاهز للاستخدام في الفرونت إند.
    -   **الحذف النظيف:** عند حذف المرفق من قاعدة البيانات، يقوم النظام تلقائياً بحذف الملف الفعلي من السيرفر لتوفير المساحة.
-   **نقاط وصول موحدة:** كنترولر ذكي يتعامل مع الطلبات بناءً على النوع (`project` أو `task`).

## التقنيات المستخدمة

-   **Laravel:** إطار العمل الأساسي.
-   **Polymorphic Relations:** استخدام `morphTo` و `morphMany`.
-   **Storage Facade:** للتعامل مع رفع وحذف الملفات في الـ `public disk`.
-   **API Resources:** لتنسيق ردود الـ JSON وإضافة روابط الصور.

## نقاط النهاية (API Endpoints)

### المشاريع والمهام

1. **عرض جميع المشاريع**

    - `GET /api/projects`
    - **الوصف:** عرض كافة المشاريع مع عدد المهام.

2. **إنشاء مشروع**

    - `POST /api/projects`
    - **الوصف:** إنشاء مشروع جديد.

3. **عرض تفاصيل المشروع**

    - `GET /api/projects/{id}`
    - **الوصف:** عرض تفاصيل المشروع (مع المهام، الملاحظات، والمرفقات).

4. **إنشاء مهمة**

    - `POST /api/tasks`
    - **الوصف:** إنشاء مهمة جديدة تابعة لمشروع.

5. **عرض تفاصيل المهمة**
    - `GET /api/tasks/{id}`
    - **الوصف:** عرض تفاصيل المهمة (مع الملاحظات والمرفقات).

### الملاحظات (Polymorphic)

نقاط النهاية الموحدة التي تخدم كلاً من المشاريع والمهام.

1. **إضافة ملاحظة**

    - `POST /api/notes`
    - **Body:**
        ```json
        {
            "body": "نص الملاحظة",
            "type": "project",
            "id": 1
        }
        ```

2. **تعديل ملاحظة**

    - `PUT /api/notes/{id}`

3. **حذف ملاحظة**
    - `DELETE /api/notes/{id}`

### المرفقات (رفع الملفات)

نقاط النهاية الموحدة التي تخدم كلاً من المشاريع والمهام.

1. **رفع ملف**

    - `POST /api/attachments`
    - **النوع:** `form-data`
    - **الحقول:**
        - `file`: (اختر الملف)
        - `type`: `task` أو `project`
        - `id`: رقم العنصر المستهدف

2. **حذف ملف**
    - `DELETE /api/attachments/{id}`
    - _ملاحظة: سيتم حذف الملف نهائياً من مساحة التخزين في السيرفر._

## التثبيت

1. **استنساخ المستودع:**

    ```bash
    git clone <repository-url>
    ```

2. **تثبيت الحزم:**

    ```bash
    composer install
    ```

3. **تكوين البيئة:**

    ```bash
    cp .env.example .env
    php artisan key:generate
    ```

4. **تشغيل الهجرات:**

    ```bash
    php artisan migrate --seed
    ```

5. **ربط التخزين (هام جداً):**

    لجعل الملفات المرفوعة قابلة للوصول عبر المتصفح:

    ```bash
    php artisan storage:link
    ```

6. **تشغيل التطبيق:**

    ```bash
    php artisan serve
    ```

## الترخيص

هذا المشروع مرخص تحت ترخيص MIT.

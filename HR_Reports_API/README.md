# نظام تقارير الموارد البشرية (HR Reports & Export API)

نظام API متخصص لإدارة سجلات الموظفين، يركز بشكل أساسي على **توليد التقارير** و **تصدير البيانات**. يتيح للمدراء تصفية الموظفين بناءً على معايير دقيقة (القسم، الراتب، سنة التعيين) وتحميل النتائج فوراً كملف **Excel/CSV** عبر تقنية الـ Streaming.

## أبرز المميزات

-   **تصدير البيانات (CSV Export):** إمكانية تحميل تقارير الموظفين بضغطة زر، مع دعم الفلترة قبل التحميل.
-   **أداء عالي (Streamed Response):** استخدام تقنية الـ Streaming لتصدير الملفات الضخمة دون استهلاك ذاكرة السيرفر.
-   **فلترة مالية وزمنية:** البحث عن الموظفين حسب نطاق الراتب أو سنة التعيين.
-   **توثيق تلقائي:** استخدام `FormRequest` لدعم أدوات التوثيق مثل Scramble.
-   **فصل المهام:** تخصيص Endpoints مستقلة للبحث (`/search`) والتصدير (`/export`).

## التقنيات المستخدمة

-   **Laravel 10/11**
-   **PHP Streams** (للتصدير الفعال)
-   **Eloquent Scopes**
-   **SQLite**
-   **Scramble** (API Documentation)

## نقاط الوصول (API Endpoints)

### التصدير والتقارير (Export)

**GET** `/api/employees/export`

يقوم هذا الرابط بتحميل ملف `.csv` يحتوي على بيانات الموظفين المفلترة.
_ملاحظة: جرب هذا الرابط في المتصفح مباشرة لتحميل الملف._

| المعامل (Parameter) | النوع     | الوصف                    |
| :------------------ | :-------- | :----------------------- |
| `department`        | `string`  | القسم (مثال: IT, HR)     |
| `min_salary`        | `number`  | الحد الأدنى للراتب       |
| `year`              | `integer` | سنة التعيين (مثال: 2024) |

**مثال للرابط (ضعه في المتصفح):**

```
http://localhost:8000/api/employees/export?department=IT&min_salary=5000
```

### البحث (Search)

**GET** `/api/employees/search`
يعرض نتائج البحث كـ JSON (للعرض في الواجهات).

### إدارة الموظفين (CRUD)

| الطريقة  | الرابط                | الوصف        |
| :------- | :-------------------- | :----------- |
| `GET`    | `/api/employees`      | عرض الكل     |
| `POST`   | `/api/employees`      | توظيف جديد   |
| `PUT`    | `/api/employees/{id}` | تعديل بيانات |
| `DELETE` | `/api/employees/{id}` | فصل موظف     |

## التثبيت والتشغيل

### 1. نسخ المستودع:

```bash
git clone <repo-url>
composer install
```

### 2. إعداد البيئة:

```bash
cp .env.example .env
php artisan key:generate
```

### 3. زراعة 200 موظف للتجربة:

```bash
php artisan migrate --seed
```

### 4. تشغيل السيرفر:

```bash
php artisan serve
```

# نظام التسجيل الجامعي الذكي (Smart University Registration API)

مشروع Backend متقدم لمحاكاة عملية التسجيل الجامعي المعقدة. يركز هذا المشروع على **الحفاظ على سلامة البيانات تحت ضغط التزامن العالي (High Concurrency)** و **فرض قواعد أكاديمية صارمة**، مشابهاً للأنظمة الأكاديمية العالمية مثل Banner و SIS.

## أبرز المميزات التقنية (Core Features)

### 1. محرك التسجيل الذكي (Smart Registration Engine)

النظام يطبق **خمس طبقات تحقق صارمة** قبل تأكيد أي تسجيل:

-   **كشف التعارض الزمني (Time Conflict Detection):** خوارزمية رياضية تمنع تداخل مواعيد المحاضرات بدقة الدقيقة الواحدة.
-   **منطق المتطلبات السابقة (Prerequisites Logic):** يمنع الطلاب من التسجيل في مواد متقدمة (مثل البرمجة 2) دون اجتياز المتطلب السابق (البرمجة 1).
-   **منع التكرار (Anti-Duplication):** يضمن عدم تسجيل الطالب في نفس المادة مرتين.
-   **إدارة السعة (Capacity Management):** التحقق من توفر المقاعد.
-   **التحكم في التزامن (Concurrency Control):** استخدام **Database Transactions** و **Pessimistic Locking** للتعامل مع التنافس على المقاعد ومنع الحجز الزائد (Overbooking) أثناء الذروة.

### 2. نظام قائمة الانتظار الآلي (Automated Waitlist System)

معالجة ذكية للشُعب الممتلئة:

-   **الطابور (Queuing):** يُضاف الطلاب إلى قائمة انتظار **FIFO (First-In-First-Out)** عندما تكون الشعبة ممتلئة.
-   **الترقية التلقائية (Auto-Promotion):** عند انسحاب طالب مسجل من مادة، النظام تلقائياً:
    1.  يرقّي أول طالب في قائمة الانتظار
    2.  يسجله في الشعبة
    3.  يحدّث السعة المتاحة فوراً

### 3. هيكلة بيانات متقدمة (Advanced Data Structure)

-   **فصل المسؤوليات (Separation of Concerns):** كيانات منفصلة لـ Courses (بيانات ثابتة) و Sections (بيانات خاصة بالفصل الدراسي).
-   **العلاقات الذاتية (Self-Referencing Relationships):** تنفيذ علاقة المرشد الأكاديمي-الطالب ضمن نفس جدول Users.
-   **الحذف الناعم (Soft Deletes):** الحفاظ على السجل الأكاديمي باستخدام الحذف الناعم للمواد والشُعب.
-   **API Resources:** تقديم استجابات JSON نظيفة ومنسقة.

### 4. الأمان والتحكم بالصلاحيات (Security & Access Control)

-   **المصادقة (Authentication):** نظام مبني على الـ Token باستخدام Laravel Sanctum.
-   **التحكم بالصلاحيات (RBAC):** فصل صارم بين صلاحيات الطالب والمرشد الأكاديمي عبر Middleware.

## التقنيات المستخدمة (Tech Stack)

-   **Framework:** Laravel 11
-   **Language:** PHP 8.2+
-   **Database:** SQLite
-   **Authentication:** Laravel Sanctum
-   **Architecture:** RESTful API, Service-Oriented Logic

## دليل الروابط (API Endpoints Overview)

### عامة (Public)

| الطريقة | الرابط          | الوصف           |
| :------ | :-------------- | :-------------- |
| `POST`  | `/api/register` | إنشاء حساب جديد |
| `POST`  | `/api/login`    | تسجيل الدخول    |

### منطقة الطالب (Student Zone) - تتطلب Token

| الطريقة  | الرابط                  | الوصف                                                   |
| :------- | :---------------------- | :------------------------------------------------------ |
| `GET`    | `/api/courses`          | عرض المواد المتاحة مع الشُعب                            |
| `GET`    | `/api/my-schedule`      | عرض جدولي الدراسي                                       |
| `POST`   | `/api/register-course`  | **التسجيل في مادة (يُفعّل محرك التحقق)**                |
| `DELETE` | `/api/drop-course/{id}` | **الانسحاب من مادة (يُفعّل الترقية من قائمة الانتظار)** |

### منطقة المرشد الأكاديمي (Advisor Zone) - تتطلب Token

| الطريقة  | الرابط               | الوصف                                   |
| :------- | :------------------- | :-------------------------------------- |
| `GET`    | `/api/users`         | عرض الطلاب المُكلف بهم فقط              |
| `POST`   | `/api/courses`       | إضافة مادة جديدة                        |
| `PUT`    | `/api/courses/{id}`  | تعديل بيانات مادة                       |
| `POST`   | `/api/sections`      | إضافة شعبة جديدة                        |
| `PUT`    | `/api/sections/{id}` | تعديل بيانات شعبة                       |
| `DELETE` | `/api/sections/{id}` | حذف شعبة (Soft Delete للحفاظ على السجل) |

## التثبيت والتشغيل (Installation)

### 1. نسخ المشروع:

```bash
git clone <your-repo-url>
cd University-System_ad
composer install
```

### 2. إعداد البيئة:

```bash
cp .env.example .env
php artisan key:generate
```

_(قم بضبط إعدادات قاعدة البيانات في ملف `.env`)_

### 3. بناء الجداول والبيانات الوهمية:

```bash
php artisan migrate:fresh --seed
```

_سيقوم هذا الأمر بإنشاء بيانات تجريبية (مواد، شُعب، طلاب، مرشدين) للتجربة._

### 4. تشغيل السيرفر:

```bash
php artisan serve
```

## سيناريوهات اختبار قوة النظام (Test Scenarios)

### اختبار 1: منع التعارض الزمني

1. سجل مادة `CS101` (الأحد 9:00-11:00)
2. حاول التسجيل في `MATH201` (الأحد 10:00-12:00)
3. النتيجة: **رفض التسجيل** بسبب التعارض الزمني

### اختبار 2: فرض المتطلبات السابقة

1. حاول التسجيل في `Programming II` بدون اجتياز `Programming I`
2. النتيجة: **رفض التسجيل** بسبب عدم تحقق المتطلب السابق

### اختبار 3: قائمة الانتظار التلقائية

1. اختر شعبة سعتها `30` وممتلئة
2. سجل كطالب جديد → ستضاف لقائمة الانتظار
3. قم بإلغاء تسجيل طالب آخر → سيتم ترقيتك تلقائياً وتسجيلك في الشعبة

### اختبار 4: Concurrency Control

1. استخدم أداة مثل Postman Runner أو Apache Benchmark
2. أرسل 50 طلب متزامن للتسجيل في آخر مقعد متبقي
3. النتيجة: **طالب واحد فقط** سينجح، الباقي سيُضافون لقائمة الانتظار

---



## الترخيص

هذا المشروع مرخص تحت [ترخيص MIT](https://opensource.org/licenses/MIT).
